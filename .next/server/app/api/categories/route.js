(()=>{var e={};e.id=9722,e.ids=[9722],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},87170:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>A,routeModule:()=>p,serverHooks:()=>m,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>g});var s={};r.r(s),r.d(s,{GET:()=>u,POST:()=>d});var a=r(96559),i=r(48088),c=r(37719),o=r(32190);let n=new(r(96330)).PrismaClient;async function u(){try{let e=(await n.category.findMany({include:{subcategories:{where:{isActive:!0},include:{_count:{select:{products:{where:{isActive:!0}}}}},orderBy:[{displayOrder:"asc"},{name:"asc"}]},_count:{select:{products:{where:{isActive:!0}}}}},orderBy:[{displayOrder:"asc"},{name:"asc"}]})).map(e=>{let t=e.subcategories.reduce((e,t)=>e+t._count.products,0),r=e._count.products+t;return{id:e.id,name:e.name,slug:e.slug,description:e.description,image:e.image,parentId:e.parentId,displayOrder:e.displayOrder,isActive:e.isActive,productCount:r,subcategories:e.subcategories.map(e=>({id:e.id,name:e.name,slug:e.slug,description:e.description,image:e.image,parentId:e.parentId,displayOrder:e.displayOrder,isActive:e.isActive,productCount:e._count.products,createdAt:e.createdAt,updatedAt:e.updatedAt})),createdAt:e.createdAt,updatedAt:e.updatedAt}});return o.NextResponse.json({success:!0,data:e,count:e.length})}catch(e){return console.error("Categories API Error:",e),o.NextResponse.json({success:!1,error:"Kategoriler y\xfcklenirken hata oluştu"},{status:500})}finally{await n.$disconnect()}}async function d(e){try{let{name:t,description:r,image:s,parentId:a,displayOrder:i,isActive:c}=await e.json();if(!t?.trim())return o.NextResponse.json({success:!1,error:"Kategori adı gereklidir"},{status:400});let u=Number(i);if(isNaN(u)||u<0||u>999)return o.NextResponse.json({success:!1,error:"G\xf6sterim sırası 0-999 arasında sayısal bir değer olmalıdır"},{status:400});if(a&&!await n.category.findUnique({where:{id:a}}))return o.NextResponse.json({success:!1,error:"\xdcst kategori bulunamadı"},{status:400});let d=t.toLowerCase().replace(/ğ/g,"g").replace(/ü/g,"u").replace(/ş/g,"s").replace(/ı/g,"i").replace(/ö/g,"o").replace(/ç/g,"c").replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"-").replace(/-+/g,"-"),p=d,l=1;for(;await n.category.findUnique({where:{slug:p}});)p=`${d}-${l}`,l++;let g=await n.category.create({data:{name:t.trim(),slug:p,description:r?.trim()||null,image:s?.trim()||null,parentId:a||null,displayOrder:u,isActive:void 0===c||c},include:{subcategories:{where:{isActive:!0},include:{_count:{select:{products:{where:{isActive:!0}}}}}},_count:{select:{products:!0}}}}),m={id:g.id,name:g.name,slug:g.slug,description:g.description,image:g.image,parentId:g.parentId,isActive:g.isActive,productCount:g._count.products,subcategories:g.subcategories.map(e=>({id:e.id,name:e.name,slug:e.slug,description:e.description,image:e.image,parentId:e.parentId,isActive:e.isActive,productCount:e._count.products,createdAt:e.createdAt,updatedAt:e.updatedAt})),createdAt:g.createdAt,updatedAt:g.updatedAt};return o.NextResponse.json({success:!0,message:"Kategori başarıyla oluşturuldu",data:m},{status:201})}catch(e){return console.error("Create category error:",e),o.NextResponse.json({success:!1,error:"Kategori oluşturulurken hata oluştu"},{status:500})}finally{await n.$disconnect()}}let p=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/categories/route",pathname:"/api/categories",filename:"route",bundlePath:"app/api/categories/route"},resolvedPagePath:"/Users/home/Desktop/site/src/app/api/categories/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:l,workUnitAsyncStorage:g,serverHooks:m}=p;function A(){return(0,c.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:g})}},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4243,580],()=>r(87170));module.exports=s})();