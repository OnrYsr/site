(()=>{var e={};e.id=4096,e.ids=[4096],e.modules={662:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>w,routeModule:()=>l,serverHooks:()=>y,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{DELETE:()=>p,GET:()=>u,PUT:()=>d});var a=r(96559),i=r(48088),n=r(37719),o=r(32190);let c=new(r(96330)).PrismaClient;async function u(e,{params:t}){try{let{id:e}=await t,r=await c.category.findUnique({where:{id:e},include:{parent:{select:{id:!0,name:!0,slug:!0}},subcategories:{where:{isActive:!0},include:{_count:{select:{products:{where:{isActive:!0}}}}}},_count:{select:{products:{where:{isActive:!0}}}}}});if(!r)return o.NextResponse.json({success:!1,error:"Kategori bulunamadı"},{status:404});let s={id:r.id,name:r.name,slug:r.slug,description:r.description,image:r.image,parentId:r.parentId,parent:r.parent,displayOrder:r.displayOrder,isActive:r.isActive,productCount:r._count.products,subcategories:r.subcategories.map(e=>({id:e.id,name:e.name,slug:e.slug,description:e.description,image:e.image,parentId:e.parentId,isActive:e.isActive,productCount:e._count.products,createdAt:e.createdAt,updatedAt:e.updatedAt})),createdAt:r.createdAt,updatedAt:r.updatedAt};return o.NextResponse.json({success:!0,data:s})}catch(e){return console.error("Get category error:",e),o.NextResponse.json({success:!1,error:"Kategori y\xfcklenirken hata oluştu"},{status:500})}finally{await c.$disconnect()}}async function d(e,{params:t}){try{let{id:r}=await t,{name:s,description:a,image:i,parentId:n,displayOrder:u,isActive:d}=await e.json(),p=await c.category.findUnique({where:{id:r}});if(!p)return o.NextResponse.json({success:!1,error:"Kategori bulunamadı"},{status:404});if(!s?.trim())return o.NextResponse.json({success:!1,error:"Kategori adı gereklidir"},{status:400});let l=Number(u);if(isNaN(l)||l<0||l>999)return o.NextResponse.json({success:!1,error:"G\xf6sterim sırası 0-999 arasında sayısal bir değer olmalıdır"},{status:400});if(n&&n!==r){if(!await c.category.findUnique({where:{id:n}}))return o.NextResponse.json({success:!1,error:"\xdcst kategori bulunamadı"},{status:400});if(n===r)return o.NextResponse.json({success:!1,error:"Kategori kendisinin alt kategorisi olamaz"},{status:400})}let g=p.slug;if(s.trim()!==p.name){let e=s.toLowerCase().replace(/ğ/g,"g").replace(/ü/g,"u").replace(/ş/g,"s").replace(/ı/g,"i").replace(/ö/g,"o").replace(/ç/g,"c").replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"-").replace(/-+/g,"-");g=e;let t=1;for(;;){let s=await c.category.findUnique({where:{slug:g}});if(!s||s.id===r)break;g=`${e}-${t}`,t++}}let m=await c.category.update({where:{id:r},data:{name:s.trim(),slug:g,description:a?.trim()||null,image:i?.trim()||null,parentId:n||null,displayOrder:l,isActive:void 0===d||d},include:{parent:{select:{id:!0,name:!0,slug:!0}},subcategories:{where:{isActive:!0},include:{_count:{select:{products:{where:{isActive:!0}}}}}},_count:{select:{products:{where:{isActive:!0}}}}}}),y={id:m.id,name:m.name,slug:m.slug,description:m.description,image:m.image,parentId:m.parentId,parent:m.parent,displayOrder:m.displayOrder,isActive:m.isActive,productCount:m._count.products,subcategories:m.subcategories.map(e=>({id:e.id,name:e.name,slug:e.slug,description:e.description,image:e.image,parentId:e.parentId,displayOrder:e.displayOrder,isActive:e.isActive,productCount:e._count.products,createdAt:e.createdAt,updatedAt:e.updatedAt})),createdAt:m.createdAt,updatedAt:m.updatedAt};return o.NextResponse.json({success:!0,message:"Kategori başarıyla g\xfcncellendi",data:y})}catch(e){return console.error("Update category error:",e),o.NextResponse.json({success:!1,error:"Kategori g\xfcncellenirken hata oluştu"},{status:500})}finally{await c.$disconnect()}}async function p(e,{params:t}){try{let{id:e}=await t,r=await c.category.findUnique({where:{id:e},include:{subcategories:!0,_count:{select:{products:!0}}}});if(!r)return o.NextResponse.json({success:!1,error:"Kategori bulunamadı"},{status:404});if(r._count.products>0)return o.NextResponse.json({success:!1,error:"Bu kategoriye ait \xfcr\xfcnler bulunmaktadır. \xd6nce \xfcr\xfcnleri başka kategoriye taşıyın veya silin."},{status:400});if(r.subcategories.length>0)return o.NextResponse.json({success:!1,error:"Bu kategorinin alt kategorileri bulunmaktadır. \xd6nce alt kategorileri silin veya başka kategoriye taşıyın."},{status:400});return await c.category.delete({where:{id:e}}),o.NextResponse.json({success:!0,message:"Kategori başarıyla silindi"})}catch(e){return console.error("Delete category error:",e),o.NextResponse.json({success:!1,error:"Kategori silinirken hata oluştu"},{status:500})}finally{await c.$disconnect()}}let l=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/categories/[id]/route",pathname:"/api/categories/[id]",filename:"route",bundlePath:"app/api/categories/[id]/route"},resolvedPagePath:"/Users/home/Desktop/site/src/app/api/categories/[id]/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:g,workUnitAsyncStorage:m,serverHooks:y}=l;function w(){return(0,n.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:m})}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4243,580],()=>r(662));module.exports=s})();